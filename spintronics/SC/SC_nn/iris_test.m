clear;
iris_data = csvread('iris_test.csv',1,0);
% layer1_weights=[6.9032,	5.04648,	-4.34227,	-5.02293;
%             -6.24207,	-5.23362,	5.34296,	3.99471;
%             14.8788,	13.9252,	-13.9821,	-14.523;
%             11.3529,	12.4055,	-11.7516,	-12.2361];
%
% layer1_biases=[-0.889334,   -0.844831,  0.799981,   0.926365];
%
% logits_weights=[-13.7329,	1.27417,	14.1756;
%             -13.4678,	-1.06278,	13.8347;
%             12.981,	1.1352,	-13.7875;
%             12.9109,	1.89396,	-13.8149];
%
% logits_biases=[0.0456089,   0.852301,   -0.779679];

    layer1_weights=[-1.0034,	2.11911,	-1.62791,	0.231651,	0.61993,	-1.83723,	-1.98954,	1.88547,	1.09951,	0.601555;
                    -2.31297,	2.67501,	-3.63939,	4.03773,	-1.5156,	-1.44924,	-1.25797,	3.04525,	3.58217,	-3.83612;
                    4.28507,	-5.71766,	4.98724,	-5.11524,	2.43317,	4.29179,	3.66089,	-4.86268,	-4.67096,	5.99592;
                    5.86411,	-7.64295,	5.87542,	-5.39865,	-1.51316,	6.6307,     5.89033,	-8.00004,	-5.9575,	4.30958];
    
    layer1_biases=[-1.55542,    1.99542,    -0.901998,  1.20303,    -0.485448,  -1.6638,    -1.14865,   1.66095,    1.18035,    -1.14597];
    
    logits_weights=[-4.95559,	-1.64442,	5.20687;
                    5.25891,	4.47529,	-7.07294;
                    -5.29129,	-0.172276,	6.47114;
                    6.06033,	-0.595987,	-5.31683;
                    -1.50574,	2.67004,	-0.467336;
                    -3.62322,	-3.19926,	5.57017;
                    -3.18659,	-2.16822,	5.83613;
                    5.02217,	3.75108,	-7.19316;
                    5.50535,	0.708707,	-6.07905;
                    -5.54193,	3.4235,     4.801];
    
    logits_biases=[-0.113811,   0.397479,   -0.1783];

layer1_weights=layer1_weights./12;
logits_weights=logits_weights./12;
layer1_biases=layer1_biases./12;
logits_biases=logits_biases./12;

accuracy=0;
for i=1:1:30
    %     i=24;
    test=0.1*iris_data(i,1:4);
    layer1_pre=test*layer1_weights+layer1_biases;
    layer1=sigmf(layer1_pre,[12,0]);
    output=layer1*logits_weights+logits_biases;
    [temp,index]=max(output);
    if (index==iris_data(i,5)+1)
        accuracy=accuracy+1;
    end
end